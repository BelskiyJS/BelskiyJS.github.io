(()=>{var e={388:(e,t,n)=>{var o,r=function(){function e(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var t=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={},a={compressToBase64:function(e){if(null==e)return"";var t=a._compress(e,6,(function(e){return n.charAt(e)}));switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,(function(o){return e(n,t.charAt(o))}))},compressToUTF16:function(e){return null==e?"":a._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=a.compress(e),n=new Uint8Array(2*t.length),o=0,r=t.length;r>o;o++){var c=t.charCodeAt(o);n[2*o]=c>>>8,n[2*o+1]=c%256}return n},decompressFromUint8Array:function(e){if(null==e)return a.decompress(e);for(var n=new Array(e.length/2),o=0,r=n.length;r>o;o++)n[o]=256*e[2*o]+e[2*o+1];var c=[];return n.forEach((function(e){c.push(t(e))})),a.decompress(c.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,(function(e){return o.charAt(e)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,(function(n){return e(o,t.charAt(n))})))},compress:function(e){return a._compress(e,16,(function(e){return t(e)}))},_compress:function(e,t,n){if(null==e)return"";var o,r,a,c={},i={},s="",l="",u="",d=2,y=3,m=2,f=[],p=0,b=0;for(a=0;a<e.length;a+=1)if(s=e.charAt(a),Object.prototype.hasOwnProperty.call(c,s)||(c[s]=y++,i[s]=!0),l=u+s,Object.prototype.hasOwnProperty.call(c,l))u=l;else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(o=0;m>o;o++)p<<=1,b==t-1?(b=0,f.push(n(p)),p=0):b++;for(r=u.charCodeAt(0),o=0;8>o;o++)p=p<<1|1&r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r>>=1}else{for(r=1,o=0;m>o;o++)p=p<<1|r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r=0;for(r=u.charCodeAt(0),o=0;16>o;o++)p=p<<1|1&r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r>>=1}0==--d&&(d=Math.pow(2,m),m++),delete i[u]}else for(r=c[u],o=0;m>o;o++)p=p<<1|1&r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r>>=1;0==--d&&(d=Math.pow(2,m),m++),c[l]=y++,u=String(s)}if(""!==u){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(o=0;m>o;o++)p<<=1,b==t-1?(b=0,f.push(n(p)),p=0):b++;for(r=u.charCodeAt(0),o=0;8>o;o++)p=p<<1|1&r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r>>=1}else{for(r=1,o=0;m>o;o++)p=p<<1|r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r=0;for(r=u.charCodeAt(0),o=0;16>o;o++)p=p<<1|1&r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r>>=1}0==--d&&(d=Math.pow(2,m),m++),delete i[u]}else for(r=c[u],o=0;m>o;o++)p=p<<1|1&r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r>>=1;0==--d&&(d=Math.pow(2,m),m++)}for(r=2,o=0;m>o;o++)p=p<<1|1&r,b==t-1?(b=0,f.push(n(p)),p=0):b++,r>>=1;for(;;){if(p<<=1,b==t-1){f.push(n(p));break}b++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(e,n,o){var r,a,c,i,s,l,u,d=[],y=4,m=4,f=3,p="",b=[],v={val:o(0),position:n,index:1};for(r=0;3>r;r+=1)d[r]=r;for(c=0,s=Math.pow(2,2),l=1;l!=s;)i=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),c|=(i>0?1:0)*l,l<<=1;switch(c){case 0:for(c=0,s=Math.pow(2,8),l=1;l!=s;)i=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),c|=(i>0?1:0)*l,l<<=1;u=t(c);break;case 1:for(c=0,s=Math.pow(2,16),l=1;l!=s;)i=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),c|=(i>0?1:0)*l,l<<=1;u=t(c);break;case 2:return""}for(d[3]=u,a=u,b.push(u);;){if(v.index>e)return"";for(c=0,s=Math.pow(2,f),l=1;l!=s;)i=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),c|=(i>0?1:0)*l,l<<=1;switch(u=c){case 0:for(c=0,s=Math.pow(2,8),l=1;l!=s;)i=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),c|=(i>0?1:0)*l,l<<=1;d[m++]=t(c),u=m-1,y--;break;case 1:for(c=0,s=Math.pow(2,16),l=1;l!=s;)i=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),c|=(i>0?1:0)*l,l<<=1;d[m++]=t(c),u=m-1,y--;break;case 2:return b.join("")}if(0==y&&(y=Math.pow(2,f),f++),d[u])p=d[u];else{if(u!==m)return null;p=a+a.charAt(0)}b.push(p),d[m++]=a+p.charAt(0),a=p,0==--y&&(y=Math.pow(2,f),f++)}}};return a}();void 0===(o=function(){return r}.call(t,n,t,e))||(e.exports=o)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};(()=>{"use strict";n.d(o,{zm:()=>p,gJ:()=>e.compressToUTF16,oo:()=>e.decompressFromUTF16,_n:()=>E,Nk:()=>b,Q9:()=>i,Uf:()=>t,RF:()=>r,dp:()=>f,gu:()=>w,vC:()=>k});var e=n(388);function t(e,t,n){return new Promise((function(o){var r=indexedDB.open(e);r.onsuccess=function(e){var a=r.result;let c=a.transaction(t,"readonly"),i=c.objectStore(t).get(n);i.onsuccess=function(){o(i.result)},c.oncomplete=function(){a.close()}}}))}function r(e,t){return new Promise((function(n){var o=indexedDB.open(e);o.onsuccess=function(e){var r=o.result;let a=r.transaction(t,"readonly"),c=a.objectStore(t).count();c.onsuccess=function(){n(c.result)},a.oncomplete=function(){r.close()}}}))}let a=document.querySelector("#ul_data_sr"),c=document.querySelector("#not-data-content");async function i(n){if(!n)return c.innerHTML="нет данных для поиска",void(a.innerHTML="");let o=await async function(e){let n=await t("my_base","sost_rab",e);return void 0===n?"":n}(n);if(!o||!o.data)return c.innerHTML=`нет данных для ${n}`,void(a.innerHTML="");let r=(0,e.decompressFromUTF16)(o.data);a.innerHTML=function(e){let t=`<li data-before='${e[0]}'>`,n=2;for(;;){let o=e.indexOf("|",n);if(-1==o)return t=t+e.slice(n)+"</li>",t;t=t+e.slice(n,o)+`</li><li data-before='${e[o+1]}'>`,n=o+3}}(r),c.innerHTML=""}let s=document.querySelector("#klava-bg"),l=document.querySelector("#klava-container"),u=(document.querySelector("#klava-button"),document.querySelector("#div-input-data")),d="";function y(e){if("klava-bg"==e.target.id){let t=document.elementsFromPoint(e.clientX,e.clientY);if(!t.find((e=>"div-input"==e.id))){if(m(),t.find((e=>"button-info"==e.className)))return void document.querySelector(".button-info").click();if(t.find((e=>e.classList.contains("obnov-data"))))return void document.querySelector(".obnov-data").click()}}}function m(){document.removeEventListener("click",y),document.querySelector(".table-input").classList.remove("input-box-shadow"),s.style.display="none"}async function f(){let e=await fetch("./base/ver.json");var t;if(e.ok)return null===(t=(await e.json())[0])||void 0===t?void 0:t.update}function p(t){return new Promise((function(n){var o=window.indexedDB.open("my_base");o.onsuccess=function(r){let a=o.result.transaction(["sost_rab","ver_base"],"readwrite"),c=a.objectStore("sost_rab");for(let n=1;n<t.length;n++)"0"==t[n].R[0]?c.delete(t[n].R.slice(1)):c.put({table:t[n].R,data:(0,e.compressToUTF16)(t[n].S).trim()});c=a.objectStore("ver_base"),c.put({name_base:"sost_rab",version:t[0].S}),a.oncomplete=function(){console.log("Транзакция выполнена"),n(!0)},a.onerror=()=>n(!1),a.onabort=()=>n(!1)}}))}async function b(){await("my_base",new Promise((function(e){var t=indexedDB.deleteDatabase("my_base");t.onsuccess=function(){e("Deleted database successfully")},t.onerror=function(){e("Couldn't delete database")},t.onblocked=function(){e("Couldn't delete database due to the operation being blocked")}})));try{(await caches.keys()).forEach((async e=>await caches.delete(e)))}catch(e){console.log(e)}"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(const t of e)t.unregister()})),document.getElementById("warning-bg").style.display="none",document.querySelector(".table-data").style.display="none",document.querySelector(".obnov-data").style.display="none",document.querySelector(".button-info").style.display="none",document.querySelector(".content").style.display="none",document.querySelector(".header").style.display="flex",document.querySelector(".header").style.justifyContent="center",document.querySelector(".not_data").style.display="block"}document.querySelectorAll(".kl_but > div").forEach((e=>e.classList.add("but_klava"))),l.addEventListener("click",(function e(t){let n=t.target.closest("div");if("DIV"!=n.tagName)return;if("but_klava"!=n.className)return;if(l.removeEventListener("click",e),n.classList.add("click-keyboard"),setTimeout((()=>{n.classList.remove("click-keyboard"),l.addEventListener("click",e)}),100),"Найти"==n.textContent)return void(async()=>{await i(d),m()})();let o="bs"==n.id?"del":n.textContent;var r,a;r=d,d="−"==(a=o)?r+"-":"×"==a?"":"del"==a?1==r.length||"У"==r[r.length-1]||"Р"==r[r.length-1]?"":r.slice(0,r.length-1):"ИЕСМЦ".includes(a[0])?a:r+a,u.textContent=d})),document.querySelector(".table-input").onclick=function(){this.classList.contains("input-box-shadow")||(this.classList.add("input-box-shadow"),s.style.display="flex",document.addEventListener("click",y))},document.querySelector(".ok-load").onclick=async()=>{document.body.style.cursor="progress";let t=document.querySelector("#warning-load-button");t.style.display="none";let n=document.querySelector(".loader");n.style.display="flex";let o=document.querySelector(".dialog-data-txt");o.textContent="Для работы приложения необходимо загрузить и установить данные.";let r=document.querySelector(".dialog-data-load"),a=await async function(t){t.textContent="Идет загрузка... ";let n=await fetch("./base/inst_base/inst_sr.json");if(!n.ok)return t.textContent="Ошибка: "+n.status,!1;try{let o=await n.text(),r=(0,e.decompressFromUTF16)(o),a=JSON.parse(r);return t.textContent="Идет установка... ",await p(a)}catch(e){return t.textContent="Ошибка: "+e.name,!1}}(r);n.style.display="none",document.body.style.cursor="default",a?o.textContent="Данные загружены и установлены.":(o.textContent="Данные не установлены.",r.textContent.startsWith("Ошибка:")&&(o.textContent+=r.textContent)),r.textContent="",document.querySelector(".ok-load").style.display="none";let c=document.querySelector(".cancel-load");c.textContent="Ok",c.onclick=async()=>{a?(document.getElementById("warning-bg").style.display="none",document.querySelector(".header").style.display="flex"):await b()},t.style.display="flex",c.focus()},document.querySelector(".cancel-load").onclick=async()=>{await b()};let v=document.querySelector("#about-bg");function g(e){"about-bg"==e.target.id&&h()}function h(){document.removeEventListener("click",g),v.style.display="none"}function w(e){if(void 0===e)return"";let t=String(e);return t.length<3?t:t.substr(0,t.length-2)+"."+t[t.length-2]+"."+t[t.length-1]}function k(e,t,n,o){let r=document.getElementById("my-dialog-cover");function a(e){"my-dialog-cover"==e.target.id&&document.getElementById("dialog-button-2").click()}function c(){document.body.style.overflowY="",n&&document.removeEventListener("click",a),document.removeEventListener("keydown",i),r.style.display="none"}function i(e){"Escape"==e.key&&document.getElementById("dialog-button-2").click(),e.preventDefault()}r.style.display="flex",document.body.style.overflowY="hidden",n&&document.addEventListener("click",a),document.getElementById("dialog-header-name").textContent=e,document.getElementById("dialog-data").textContent=t,document.getElementById("dialog-button-1").focus(),document.getElementById("dialog-button-1").onclick=function(){c(),o()},document.getElementById("dialog-button-2").onclick=function(){c()},document.getElementById("dialog-header-close").onclick=function(){document.getElementById("dialog-button-2").click()},document.addEventListener("keydown",i),document.getElementById("dialog-button-1").onkeydown=function(e){if("Tab"==e.key||"ArrowRight"==e.key||"Enter"==e.key)return"Enter"==e.key?this.click():document.getElementById("dialog-button-2").focus(),!1},document.getElementById("dialog-button-2").onkeydown=function(e){if("Tab"==e.key||"ArrowLeft"==e.key||"Enter"==e.key)return"Enter"==e.key?this.click():document.getElementById("dialog-button-1").focus(),!1}}document.querySelector(".button-info").onclick=async()=>{document.querySelector("#about-app").textContent=E;let e=await t("my_base","ver_base","sost_rab");document.querySelector("#about-version").textContent=w(null==e?void 0:e.version);let n=await r("my_base","sost_rab");if(document.querySelector("#about-record").textContent=n,navigator.storage&&navigator.storage.estimate){const e=await navigator.storage.estimate(),t=e.quota,n=e.usage;Math.round(n/t*100),document.querySelector("#about-memory_user").textContent=Math.round(n/1048576)+"Мб",document.querySelector("#about-memory_all").textContent=Math.round(t/1048576)+"Мб"}document.getElementById("about-bg").style.display="flex",document.addEventListener("click",g)},document.getElementById("about-close").onclick=function(){h()},document.getElementById("about-delete").onclick=function(){k("Удаление","Удалить данные ?",!1,(async()=>{await b(),h()}))};let x=document.querySelector(".loader-info"),S=document.getElementById("update-bg");async function _(t){x.textContent="Идет загрузка версии "+w(t);let n=await fetch(`./base/obn_base/${t}.json`);if(!n.ok)return"Ошибка: "+n.status+` для версии ${w(t)}`;try{let o=await n.text(),r=(0,e.decompressFromUTF16)(o),a=JSON.parse(r);return x.textContent="Идет установка версии "+w(t),await p(a)?"":`Ошибка установки данных для версии ${w(t)}`}catch(e){return"Ошибка: "+e.name+` для версии ${w(t)}`}}document.querySelector(".obnov-data").onclick=async()=>{let e=document.querySelector("#ul_data_sr"),n=document.querySelector("#not-data-content");e.innerHTML="",n.innerHTML="",S.style.display="flex";let o,r=await t("my_base","ver_base","sost_rab"),a=await f();document.getElementById("update-process").style.display="flex";for(let e=+r.version+1;e<=+a&&(o=await _(String(e)),0===o.length);e++);document.getElementById("update-process").style.display="none",document.getElementById("update-itog").style.display="block",0!==o.length&&(document.querySelector(".update-itog-info").textContent=o),document.querySelector(".update-button").focus()},document.querySelector(".update-button").onclick=()=>{document.getElementById("update-itog").style.display="none",S.style.display="none",document.querySelector(".obnov-data").style.display="none"};const E="1.0.1";window.addEventListener("load",(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then((e=>{console.log("Service worker successfully registered",e)})).catch((e=>{console.log("Service worker registration failed",e)}))})),window.onload=async function(){await("my_base",1,new Promise((function(e){var t=window.indexedDB.open("my_base",1);t.onupgradeneeded=function(){var e=t.result;e.objectStoreNames.contains("sost_rab")||e.createObjectStore("sost_rab",{keyPath:"table"}),e.objectStoreNames.contains("ver_base")||e.createObjectStore("ver_base",{keyPath:"name_base"})},t.onsuccess=function(){var n=t.result;e(n)},t.onerror=function(e){alert("Enable to access IndexedDB, "+e.target.errorCode)}})));let e=await t("my_base","ver_base","sost_rab");if(void 0===e)document.getElementById("warning-bg").style.display="flex",document.querySelector(".ok-load").focus();else{document.querySelector(".header").style.display="flex";let t=await f();if(void 0===t)return;e.version<t&&(document.querySelector(".obnov-data").style.display="flex")}}()})()})();